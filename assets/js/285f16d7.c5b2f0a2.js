"use strict";(self.webpackChunkarmada_alliance_docusaurus=self.webpackChunkarmada_alliance_docusaurus||[]).push([[4198],{7878:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var r=t(4848),a=t(8453);t(1470),t(9365);const s={description:"optimize hardware, harden Ubuntu"},i="Server Setup",o={id:"stake-pool-guides/pi-pool-tutorial/pi-node-full-guide/server-setup",title:"Server Setup",description:"optimize hardware, harden Ubuntu",source:"@site/docs/stake-pool-guides/pi-pool-tutorial/pi-node-full-guide/server-setup.md",sourceDirName:"stake-pool-guides/pi-pool-tutorial/pi-node-full-guide",slug:"/stake-pool-guides/pi-pool-tutorial/pi-node-full-guide/server-setup",permalink:"/docs/stake-pool-guides/pi-pool-tutorial/pi-node-full-guide/server-setup",draft:!1,unlisted:!1,editUrl:"https://github.com/armada-alliance/docs/edit/master/docs/stake-pool-guides/pi-pool-tutorial/pi-node-full-guide/server-setup.md",tags:[],version:"current",frontMatter:{description:"optimize hardware, harden Ubuntu"},sidebar:"tutorialSidebar",previous:{title:"User Setup",permalink:"/docs/stake-pool-guides/pi-pool-tutorial/pi-node-full-guide/user-setup"},next:{title:"Environment Setup",permalink:"/docs/stake-pool-guides/pi-pool-tutorial/pi-node-full-guide/environment-setup"}},l={},c=[{value:"Configure Hardware",id:"configure-hardware",level:2},{value:"Overclock, memory &amp; radios",id:"overclock-memory--radios",level:3},{value:"Configure Ubuntu",id:"configure-ubuntu",level:2},{value:"Disable the root user",id:"disable-the-root-user",level:3},{value:"Secure shared memory",id:"secure-shared-memory",level:3},{value:"Increase open file limit for $USER",id:"increase-open-file-limit-for-user",level:3},{value:"Optimize performance &amp; security",id:"optimize-performance--security",level:3},{value:"Disable IRQ balance",id:"disable-irq-balance",level:3},{value:"Chrony",id:"chrony",level:3},{value:"Zram swap",id:"zram-swap",level:3},{value:"Raspberry Pi &amp; entropy",id:"raspberry-pi--entropy",level:3},{value:"Automatic security updates",id:"automatic-security-updates",level:2},{value:"Install packages",id:"install-packages",level:2},{value:"Optionally test drive speed",id:"optionally-test-drive-speed",level:3},{value:"Write speed",id:"write-speed",level:4},{value:"Read speed",id:"read-speed",level:4}];function d(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"server-setup",children:"Server Setup"}),"\n",(0,r.jsx)(n.h2,{id:"configure-hardware",children:"Configure Hardware"}),"\n",(0,r.jsx)(n.p,{children:"Let's save some power, raise the governor on the CPU a bit, and set GPU ram as low as we can."}),"\n",(0,r.jsxs)(n.admonition,{type:"caution",children:[(0,r.jsx)(n.p,{children:"Here are some links for overclocking and testing your drive speeds. If you have heat sinks you can safely go to 2000. Just pay attention to over volt recommendations to go with your chosen clock speed."}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.raspberrypi.org/documentation/configuration/config-txt/overclocking.md",children:"https://www.raspberrypi.org/documentation/configuration/config-txt/overclocking.md"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.seeedstudio.com/blog/2020/02/12/how-to-safely-overclock-your-raspberry-pi-4-to-2-147ghz/",children:"https://www.seeedstudio.com/blog/2020/02/12/how-to-safely-overclock-your-raspberry-pi-4-to-2-147ghz/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.tomshardware.com/how-to/raspberry-pi-4-23-ghz-overclock",children:"https://www.tomshardware.com/how-to/raspberry-pi-4-23-ghz-overclock"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://dopedesi.com/2020/11/24/upgrade-your-raspberry-pi-4-with-a-nvme-boot-drive-by-alex-ellis-nov-2020/",children:"https://dopedesi.com/2020/11/24/upgrade-your-raspberry-pi-4-with-a-nvme-boot-drive-by-alex-ellis-nov-2020/"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://jamesachambers.com/new-raspberry-pi-4-bootloader-usb-network-boot-guide/",children:"Legendary Technology: New Raspberry Pi 4 Bootloader USB"})}),"\n"]}),(0,r.jsx)(n.p,{children:"Take note that Ubuntu stores config.txt in a different location than Raspbian."})]}),"\n",(0,r.jsx)(n.h3,{id:"overclock-memory--radios",children:"Overclock, memory & radios"}),"\n",(0,r.jsx)(n.p,{children:"Edit /boot/firmware/config.txt. Just paste Pi Node additions in at the bottom."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo nano /boot/firmware/config.txt\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="/boot/firmware/config.txt"',children:"## Pi Node ##\nover_voltage=6\narm_freq=2000\ngpu_mem=16\ndtoverlay=disable-wifi\ndtoverlay=disable-bt\n"})}),"\n",(0,r.jsx)(n.p,{children:"Save and reboot."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo reboot\n"})}),"\n",(0,r.jsx)(n.h2,{id:"configure-ubuntu",children:"Configure Ubuntu"}),"\n",(0,r.jsx)(n.h3,{id:"disable-the-root-user",children:"Disable the root user"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo passwd -l root\n"})}),"\n",(0,r.jsx)(n.h3,{id:"secure-shared-memory",children:"Secure shared memory"}),"\n",(0,r.jsx)(n.p,{children:"Mount shared memory as read only. Open /etc/fstab."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo nano /etc/fstab\n"})}),"\n",(0,r.jsx)(n.p,{children:"Add this line at the bottom, save & exit."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="/etc/fstab"',children:"tmpfs    /run/shm    tmpfs    ro,noexec,nosuid    0 0\n"})}),"\n",(0,r.jsx)(n.h3,{id:"increase-open-file-limit-for-user",children:"Increase open file limit for $USER"}),"\n",(0,r.jsx)(n.p,{children:"Add a couple lines to the bottom of /etc/security/limits.conf"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo bash -c \"echo -e '${USER} soft nofile 800000\\n${USER} hard nofile 1048576\\n' >> /etc/security/limits.conf\"\n"})}),"\n",(0,r.jsx)(n.p,{children:"Confirm it was added to the bottom."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"cat /etc/security/limits.conf\n"})}),"\n",(0,r.jsx)(n.h3,{id:"optimize-performance--security",children:"Optimize performance & security"}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://gist.github.com/lokhman/cc716d2e2d373dd696b2d9264c0287a3",children:"https://gist.github.com/lokhman/cc716d2e2d373dd696b2d9264c0287a3"})})}),"\n",(0,r.jsx)(n.admonition,{type:"caution",children:(0,r.jsx)(n.p,{children:"If you would like to disable ipv6 or turn on forwarding you can below."})}),"\n",(0,r.jsx)(n.p,{children:"Add the following to the bottom of /etc/sysctl.d/99-sysctl.conf. Save and exit."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo nano /etc/sysctl.d/99-sysctl.conf\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="/etc/sysctl.d/99-sysctl.conf"',children:"\nfs.file-max = 10000000\nfs.nr_open = 10000000\n\n# ignore ICMP redirects\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\n\nnet.ipv4.icmp_ignore_bogus_error_responses = 1\n\n# disable IPv6\n#net.ipv6.conf.all.disable_ipv6 = 1\n#net.ipv6.conf.default.disable_ipv6 = 1\n\n# block SYN attacks\nnet.ipv4.tcp_syncookies = 1\nnet.ipv4.tcp_max_syn_backlog = 2048\nnet.ipv4.tcp_synack_retries = 3\nnet.ipv4.netfilter.ip_conntrack_tcp_timeout_syn_recv=45\n\n# in progress tasks\nnet.ipv4.tcp_keepalive_time = 240\nnet.ipv4.tcp_keepalive_intvl = 4\nnet.ipv4.tcp_keepalive_probes = 5\n\n# reboot if we run out of memory\nvm.panic_on_oom = 1\nkernel.panic = 10\n\n# Use Google's congestion control algorithm\nnet.core.default_qdisc = fq\nnet.ipv4.tcp_congestion_control = bbr\n"})}),"\n",(0,r.jsx)(n.h3,{id:"disable-irq-balance",children:"Disable IRQ balance"}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"http://bookofzeus.com/harden-ubuntu/server-setup/disable-irqbalance/",children:(0,r.jsx)(n.strong,{children:"http://bookofzeus.com/harden-ubuntu/server-setup/disable-irqbalance/"})})})}),"\n",(0,r.jsx)(n.p,{children:"You should turn off IRQ Balance to make sure you do not get hardware interrupts in your threads. Turning off IRQ Balance will optimize the balance between power savings and performance through the distribution of hardware interrupts across multiple processors."}),"\n",(0,r.jsx)(n.p,{children:"Open /etc/default/irqbalance and add to the bottom. Save, exit and reboot."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo nano /etc/default/irqbalance\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="/etc/default/irqbalance"',children:'ENABLED="0"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"chrony",children:"Chrony"}),"\n",(0,r.jsx)(n.p,{children:"We need to get our time synchronization as accurate as possible. Open /etc/chrony/chrony.conf"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo apt install chrony\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo nano /etc/chrony/chrony.conf\n"})}),"\n",(0,r.jsx)(n.p,{children:"Replace the contents of the file with below, Save and exit."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="/etc/chrony/chrony.conf"',children:"pool time.google.com       iburst minpoll 2 maxpoll 2 maxsources 3 maxdelay 0.3\npool time.euro.apple.com   iburst minpoll 2 maxpoll 2 maxsources 3 maxdelay 0.3\npool time.apple.com        iburst minpoll 2 maxpoll 2 maxsources 3 maxdelay 0.3\npool ntp.ubuntu.com        iburst minpoll 2 maxpoll 2 maxsources 3 maxdelay 0.3\n\n# This directive specify the location of the file containing ID/key pairs for\n# NTP authentication.\nkeyfile /etc/chrony/chrony.keys\n\n# This directive specify the file into which chronyd will store the rate\n# information.\ndriftfile /var/lib/chrony/chrony.drift\n\n# Uncomment the following line to turn logging on.\n#log tracking measurements statistics\n\n# Log files location.\nlogdir /var/log/chrony\n\n# Stop bad estimates upsetting machine clock.\nmaxupdateskew 5.0\n\n# This directive enables kernel synchronisation (every 11 minutes) of the\n# real-time clock. Note that it can\u2019t be used along with the 'rtcfile' directive.\nrtcsync\n\n# Step the system clock instead of slewing it if the adjustment is larger than\n# one second, but only in the first three clock updates.\nmakestep 0.1 -1\n\n# Get TAI-UTC offset and leap seconds from the system tz database\nleapsectz right/UTC\n\n# Serve time even if not synchronized to a time source.\nlocal stratum 10\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo service chrony restart\n"})}),"\n",(0,r.jsx)(n.h3,{id:"zram-swap",children:"Zram swap"}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsx)(n.p,{children:"We have found that cardano-node can safely use this compressed swap in ram essentially giving us around 20gb of ram. We already set kernel parameters for zram in /etc/sysctl.conf"})}),"\n",(0,r.jsx)(n.p,{children:"Swapping to disk is slow, swapping to compressed ram space is faster and gives us some overhead before out of memory (oom)."}),"\n",(0,r.jsxs)(n.admonition,{title:"MORE INFO ABOUT ZRAM",type:"tip",children:[(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://haydenjames.io/raspberry-pi-performance-add-zram-kernel-parameters/",children:"https://haydenjames.io/raspberry-pi-performance-add-zram-kernel-parameters/"})}),(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://lists.ubuntu.com/archives/lubuntu-users/2013-October/005831.html",children:"https://lists.ubuntu.com/archives/lubuntu-users/2013-October/005831.html"})})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo apt install zram-config linux-modules-extra-raspi\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo nano /usr/bin/init-zram-swapping\n"})}),"\n",(0,r.jsx)(n.p,{children:"Switch compression algorithm to lz4. Multiply the default mem variable by 3 like below. This will give the instance 35gb of compressed virtual swap in RAM. Increase vm.swappiness to 150."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="/usr/bin/init-zram-swapping"',children:"mem=$((totalmem / 2 * 1024 * 3))\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="/usr/bin/init-zram-swapping"',children:"#!/bin/sh\n\nmodprobe zram\n\n# Calculate memory to use for zram (1/2 of ram)\ntotalmem=`LC_ALL=C free | grep -e \"^Mem:\" | sed -e 's/^Mem: *//' -e 's/  *.*//'`\necho lz4 > /sys/block/zram0/comp_algorithm\nmem=$((totalmem / 2 * 1024 * 3))\n\n# initialize the devices\necho $mem > /sys/block/zram0/disksize\nmkswap /dev/zram0\nswapon -p 150 /dev/zram0\n"})}),"\n",(0,r.jsx)(n.h3,{id:"raspberry-pi--entropy",children:"Raspberry Pi & entropy"}),"\n",(0,r.jsx)(n.p,{children:"Before we start generating keys with a headless server we should have a safe amount of entropy."}),"\n",(0,r.jsxs)(n.admonition,{title:"MORE INFO ABOUT ENTROPY",type:"tip",children:[(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://hackaday.com/2017/11/02/what-is-entropy-and-how-do-i-get-more-of-it/",children:"https://hackaday.com/2017/11/02/what-is-entropy-and-how-do-i-get-more-of-it/"})}),(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://github.com/nhorman/rng-tools",children:"https://github.com/nhorman/rng-tools"})})]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["But consider the fate of a standalone, headless server (or a micro controller for that matter) with no human typing or mousing around, and no spinning iron drive providing mechanical irregularity. Where does ",(0,r.jsx)(n.em,{children:"it"})," get entropy after it starts up? What if an attacker, or bad luck, forces periodic reboots? This is a ",(0,r.jsx)(n.a,{href:"http://www.theregister.co.uk/2015/12/02/raspberry_pi_weak_ssh_keys/",children:"real problem"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo apt-get install rng-tools\n"})}),"\n",(0,r.jsx)(n.h2,{id:"automatic-security-updates",children:"Automatic security updates"}),"\n",(0,r.jsx)(n.p,{children:"Enable automatic security updates."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo dpkg-reconfigure -plow unattended-upgrades\n"})}),"\n",(0,r.jsx)(n.h2,{id:"install-packages",children:"Install packages"}),"\n",(0,r.jsx)(n.p,{children:"Install the packages we will need."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo apt install build-essential libssl-dev tcptraceroute python3-pip flex \\\n         make automake unzip net-tools ssl-cert pkg-config  g++ bison \\\n         libffi-dev libgmp-dev libssl-dev libtinfo-dev libsystemd-dev autoconf \\\n         zlib1g-dev libncursesw5 llvm-12 numactl libnuma-dev libtool libsecp256k1-dev -y\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo reboot\n"})}),"\n",(0,r.jsx)(n.h3,{id:"optionally-test-drive-speed",children:"Optionally test drive speed"}),"\n",(0,r.jsx)(n.h4,{id:"write-speed",children:"Write speed"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo dd if=/dev/zero of=/tmp/output conv=fdatasync bs=384k count=1k; sudo rm -f /tmp/output\n"})}),"\n",(0,r.jsx)(n.h4,{id:"read-speed",children:"Read speed"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo hdparm -Tt /dev/sda\n"})})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},9365:(e,n,t)=>{t.d(n,{A:()=>i});t(6540);var r=t(8215);const a={tabItem:"tabItem_Ymn6"};var s=t(4848);function i(e){let{children:n,hidden:t,className:i}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.A)(a.tabItem,i),hidden:t,children:n})}},1470:(e,n,t)=>{t.d(n,{A:()=>w});var r=t(6540),a=t(8215),s=t(3104),i=t(6347),o=t(205),l=t(7485),c=t(1682),d=t(679);function u(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:a}}=e;return{value:n,label:t,attributes:r,default:a}}))}(t);return function(e){const n=(0,c.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function h(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:t}=e;const a=(0,i.W6)(),s=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,l.aZ)(s),(0,r.useCallback)((e=>{if(!s)return;const n=new URLSearchParams(a.location.search);n.set(s,e),a.replace({...a.location,search:n.toString()})}),[s,a])]}function g(e){const{defaultValue:n,queryString:t=!1,groupId:a}=e,s=p(e),[i,l]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!h({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=t.find((e=>e.default))??t[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:s}))),[c,u]=m({queryString:t,groupId:a}),[g,f]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[a,s]=(0,d.Dv)(t);return[a,(0,r.useCallback)((e=>{t&&s.set(e)}),[t,s])]}({groupId:a}),b=(()=>{const e=c??g;return h({value:e,tabValues:s})?e:null})();(0,o.A)((()=>{b&&l(b)}),[b]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!h({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),f(e)}),[u,f,s]),tabValues:s}}var f=t(2303);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var v=t(4848);function x(e){let{className:n,block:t,selectedValue:r,selectValue:i,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.a_)(),d=e=>{const n=e.currentTarget,t=l.indexOf(n),a=o[t].value;a!==r&&(c(n),i(a))},u=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":t},n),children:o.map((e=>{let{value:n,label:t,attributes:s}=e;return(0,v.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>l.push(e),onKeyDown:u,onClick:d,...s,className:(0,a.A)("tabs__item",b.tabItem,s?.className,{"tabs__item--active":r===n}),children:t??n},n)}))})}function y(e){let{lazy:n,children:t,selectedValue:a}=e;const s=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==a})))})}function j(e){const n=g(e);return(0,v.jsxs)("div",{className:(0,a.A)("tabs-container",b.tabList),children:[(0,v.jsx)(x,{...n,...e}),(0,v.jsx)(y,{...n,...e})]})}function w(e){const n=(0,f.A)();return(0,v.jsx)(j,{...e,children:u(e.children)},String(n))}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var r=t(6540);const a={},s=r.createContext(a);function i(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);