"use strict";(self.webpackChunkarmada_alliance_docusaurus=self.webpackChunkarmada_alliance_docusaurus||[]).push([[9370],{8462:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>l});var t=s(4848),o=s(8453);const a={description:"Create the ada user, add to group sudo"},i="User Setup",r={id:"stake-pool-guides/pi-pool-tutorial/pi-node-full-guide/user-setup",title:"User Setup",description:"Create the ada user, add to group sudo",source:"@site/docs/stake-pool-guides/pi-pool-tutorial/pi-node-full-guide/user-setup.md",sourceDirName:"stake-pool-guides/pi-pool-tutorial/pi-node-full-guide",slug:"/stake-pool-guides/pi-pool-tutorial/pi-node-full-guide/user-setup",permalink:"/docs/stake-pool-guides/pi-pool-tutorial/pi-node-full-guide/user-setup",draft:!1,unlisted:!1,editUrl:"https://github.com/armada-alliance/docs/edit/master/docs/stake-pool-guides/pi-pool-tutorial/pi-node-full-guide/user-setup.md",tags:[],version:"current",frontMatter:{description:"Create the ada user, add to group sudo"},sidebar:"tutorialSidebar",previous:{title:"Logging in Securely",permalink:"/docs/stake-pool-guides/pi-pool-tutorial/pi-node-full-guide/logging-in-securely"},next:{title:"Server Setup",permalink:"/docs/stake-pool-guides/pi-pool-tutorial/pi-node-full-guide/server-setup"}},d={},l=[{value:"Create the ada user",id:"create-the-ada-user",level:2},{value:"Change password",id:"change-password",level:3},{value:"Login as ada",id:"login-as-ada",level:3},{value:"ssh",id:"ssh",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"user-setup",children:"User Setup"}),"\n",(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsx)(n.p,{children:"If you are using a Pi-Node image you need only reference this material. The guide builds the image you can download."})}),"\n",(0,t.jsx)(n.h2,{id:"create-the-ada-user",children:"Create the ada user"}),"\n",(0,t.jsx)(n.p,{children:"Create a new user and add it to the sudo group."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo adduser ada; sudo adduser ada sudo\n"})}),"\n",(0,t.jsx)(n.h3,{id:"change-password",children:"Change password"}),"\n",(0,t.jsx)(n.p,{children:"You can change the users password at anytime with."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"passwd\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsx)(n.p,{children:"Careful where you use sudo. For example issuing 'sudo passwd' would change the root password. This seems to be a place where new users get confused."})}),"\n",(0,t.jsx)(n.h3,{id:"login-as-ada",children:"Login as ada"}),"\n",(0,t.jsx)(n.p,{children:"Let's add our ssh public key to our new $USER ada's authorized_keys file. Then we can log in as ada and delete the default 'ubuntu' user."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"# drop back into your local terminal\nexit\n"})}),"\n",(0,t.jsx)(n.p,{children:"Use ssh-copy-id to add your public key to ada users authorized_keys file."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"ssh-copy-id -i <ed25519-keyname.pub> ada@<server-ip>\n"})}),"\n",(0,t.jsx)(n.p,{children:"and ssh into the Pi as ada."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"ssh ada@<server-ip>\n"})}),"\n",(0,t.jsx)(n.p,{children:"Test that ada is in the sudo group by updating your package lists and upgrading the system."}),"\n",(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsx)(n.p,{children:"If you get error about repos and time it is because the clock is not set. Install chrony now to fix, otherwise we will install and configure it later."})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo apt update; sudo apt upgrade -y\n"})}),"\n",(0,t.jsx)(n.p,{children:"We can delete the default ubuntu user and it's home directory."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo deluser --remove-home ubuntu\n"})}),"\n",(0,t.jsx)(n.h2,{id:"ssh",children:"ssh"}),"\n",(0,t.jsx)(n.p,{children:"Edit OpenSSH's configuration file and make the following changes with Nano text editor."}),"\n",(0,t.jsxs)(n.admonition,{type:"info",children:[(0,t.jsxs)(n.p,{children:["Check out this ",(0,t.jsx)(n.a,{href:"https://www.nano-editor.org/dist/latest/cheatsheet.html",children:"nano cheat sheet"})," I just found!"]}),(0,t.jsx)(n.p,{children:"All the # commented out values in sshd_config are the default values. Remove the pound sign and change the value to match below. They will be loaded the next time systemd restarts ssh."})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"sudo nano /etc/ssh/sshd_config\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsx)(n.p,{children:"Turn off password authentication."})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'title=">_ Terminal"',children:"#    $OpenBSD: sshd_config,v 1.103 2018/04/09 20:41:22 tj Exp $\n\n# This is the sshd server system-wide configuration file.  See\n# sshd_config(5) for more information.\n\n# This sshd was compiled with PATH=/usr/bin:/bin:/usr/sbin:/sbin\n\n# The strategy used for options in the default sshd_config shipped with\n# OpenSSH is to specify options with their default value where\n# possible, but leave them commented.  Uncommented options override the\n# default value.\n\nInclude /etc/ssh/sshd_config.d/*.conf\n\n#Port 22\n#AddressFamily any\n#ListenAddress 0.0.0.0\n#ListenAddress ::\n\n#HostKey /etc/ssh/ssh_host_rsa_key\n#HostKey /etc/ssh/ssh_host_ecdsa_key\n#HostKey /etc/ssh/ssh_host_ed25519_key\n\n# Ciphers and keying\n#RekeyLimit default none\n\n# Logging\n#SyslogFacility AUTH\n#LogLevel INFO\n\n# Authentication:\n\n#LoginGraceTime 2m\n#PermitRootLogin prohibit-password\n#StrictModes yes\n#MaxAuthTries 2\n#MaxSessions 10\n\n#PubkeyAuthentication yes\n\n# Expect .ssh/authorized_keys2 to be disregarded by default in future.\n#AuthorizedKeysFile    .ssh/authorized_keys .ssh/authorized_keys2\n\n#AuthorizedPrincipalsFile none\n\n#AuthorizedKeysCommand none\n#AuthorizedKeysCommandUser nobody\n\n# For this to work you will also need host keys in /etc/ssh/ssh_known_hosts\n#HostbasedAuthentication no\n# Change to yes if you don't trust ~/.ssh/known_hosts for\n# HostbasedAuthentication\n#IgnoreUserKnownHosts no\n# Don't read the user's ~/.rhosts and ~/.shosts files\n#IgnoreRhosts yes\n\n# To disable tunneled clear text passwords, change to no here!\nPasswordAuthentication no\n#PermitEmptyPasswords no\n\n# Change to yes to enable challenge-response passwords (beware issues with\n# some PAM modules and threads)\nChallengeResponseAuthentication no\n\n# Kerberos options\n#KerberosAuthentication no\n#KerberosOrLocalPasswd yes\n#KerberosTicketCleanup yes\n#KerberosGetAFSToken no\n\n# GSSAPI options\n#GSSAPIAuthentication no\n#GSSAPICleanupCredentials yes\n#GSSAPIStrictAcceptorCheck yes\n#GSSAPIKeyExchange no\n\n# Set this to 'yes' to enable PAM authentication, account processing,\n# and session processing. If this is enabled, PAM authentication will\n# be allowed through the ChallengeResponseAuthentication and\n# PasswordAuthentication.  Depending on your PAM configuration,\n# PAM authentication via ChallengeResponseAuthentication may bypass\n# the setting of \"PermitRootLogin without-password\".\n# If you just want the PAM account and session checks to run without\n# PAM authentication, then enable this but set PasswordAuthentication\n# and ChallengeResponseAuthentication to 'no'.\nUsePAM yes\n\n#AllowAgentForwarding yes\n#AllowTcpForwarding yes\n#GatewayPorts no\nX11Forwarding yes\n#X11DisplayOffset 10\n#X11UseLocalhost yes\n#PermitTTY yes\nPrintMotd no\n#PrintLastLog yes\n#TCPKeepAlive yes\n#PermitUserEnvironment no\n#Compression delayed\n#ClientAliveInterval 0\n#ClientAliveCountMax 3\n#UseDNS no\n#PidFile /var/run/sshd.pid\n#MaxStartups 10:30:100\n#PermitTunnel no\n#ChrootDirectory none\n#VersionAddendum none\n\n# no default banner path\n#Banner none\n\n# Allow client to pass locale environment variables\nAcceptEnv LANG LC_*\n\n# override default of no subsystems\nSubsystem sftp  /usr/lib/openssh/sftp-server\n\n# Example of overriding settings on a per-user basis\n#Match User anoncvs\n#       X11Forwarding no\n#       AllowTcpForwarding no\n#       PermitTTY no\n#       ForceCommand cvs server\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsx)(n.p,{children:"I am not a proponent of changing default ports when I don't have to. A strong key pair and fail2ban is enough for me. It is not too hard for an attacker to figure out what port ssh is listening on if they really want to."})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>r});var t=s(6540);const o={},a=t.createContext(o);function i(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);